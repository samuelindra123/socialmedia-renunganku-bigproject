<style>
  :host {
    font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    box-sizing: border-box;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    color: #0f172a;
  }

  * {
    box-sizing: inherit;
  }

  body {
    margin: 0;
  }

  .page {
    min-height: 100vh;
    display: flex;
    padding: 1.5rem;
    background: #f1f5f9;
  }

  .page--auth {
    align-items: center;
    justify-content: center;
  }

  .page--shell {
    align-items: stretch;
    justify-content: center;
  }

  .card {
    width: 100%;
    max-width: 420px;
    background: #ffffff;
    border-radius: 1rem;
    border: 1px solid #e2e8f0;
    box-shadow: 0 20px 40px rgba(15, 23, 42, 0.08);
    padding: 2rem 2.25rem;
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
  }

  /* Card khusus di layout admin (sidebar + konten) */
  .shell-card {
    width: auto;
    max-width: none;
    flex: 1 1 0;
    min-width: 0; /* izinkan menyusut agar tidak dorong layout */
  }

  .card-header {
    display: flex;
    flex-direction: column;
    gap: 0.9rem;
  }

  .layout {
    display: flex;
    align-items: stretch;
    justify-content: center;
    gap: 1.5rem;
    width: 100%;
    max-width: 100%;
    margin: 0 auto;
  }

  .sidebar {
    width: 240px;
    border-radius: 1rem;
    border: 1px solid #e2e8f0;
    background: #0f172a;
    color: #e5e7eb;
    padding: 1.25rem 1.4rem;
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .sidebar-title {
    font-size: 0.85rem;
    text-transform: uppercase;
    letter-spacing: 0.12em;
    color: #9ca3af;
  }

  .sidebar-nav {
    display: flex;
    flex-direction: column;
    gap: 0.35rem;
    font-size: 0.9rem;
  }

  .sidebar-nav-item {
    padding: 0.4rem 0;
  }

  .sidebar-nav-item--active {
    font-weight: 600;
    color: #f9fafb;
  }

  .sidebar-footer {
    margin-top: auto;
    font-size: 0.75rem;
    color: #9ca3af;
  }

  .brand-row {
    display: flex;
    align-items: center;
    gap: 0.6rem;
  }

  .brand-mark {
    position: relative;
    width: 1.75rem;
    height: 1.75rem;
    border-radius: 0.6rem;
    background: #020617;
  }

  .brand-mark-cross-vert,
  .brand-mark-cross-horz {
    position: absolute;
    background: #e5e7eb;
    border-radius: 999px;
  }

  .brand-mark-cross-vert {
    width: 2px;
    height: 70%;
    left: 50%;
    top: 15%;
    transform: translateX(-50%);
  }

  .brand-mark-cross-horz {
    height: 2px;
    width: 70%;
    left: 15%;
    top: 50%;
    transform: translateY(-50%);
  }

  .brand-text {
    display: flex;
    flex-direction: column;
    gap: 0.1rem;
  }

  .brand-name {
    font-size: 0.8rem;
    font-weight: 600;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    color: #0f172a;
  }

  .brand-subtitle {
    font-size: 0.75rem;
    color: #64748b;
  }

  h1 {
    font-size: 1.35rem;
    font-weight: 600;
    letter-spacing: -0.03em;
    margin: 0;
    color: #020617;
  }

  .lead {
    margin: 0;
    font-size: 0.9rem;
    color: #6b7280;
  }

  .form {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .field {
    display: flex;
    flex-direction: column;
    gap: 0.35rem;
  }

  label {
    font-size: 0.8rem;
    font-weight: 500;
    color: #4b5563;
  }

  input[type='email'],
  input[type='password'] {
    border-radius: 0.7rem;
    border: 1px solid #d1d5db;
    padding: 0.6rem 0.75rem;
    font-size: 0.85rem;
    color: #0f172a;
    outline: none;
    background: #f9fafb;
  }

  input::placeholder {
    color: #9ca3af;
  }

  input:focus {
    border-color: #020617;
    background: #ffffff;
  }

  .form-row {
    display: flex;
    align-items: center;
    justify-content: flex-start;
    font-size: 0.78rem;
    color: #6b7280;
  }

  .remember {
    display: flex;
    align-items: center;
    gap: 0.35rem;
  }

  .remember input {
    width: 0.85rem;
    height: 0.85rem;
  }

  .link {
    color: #020617;
    text-decoration: none;
    font-weight: 500;
  }

  .link:hover {
    text-decoration: underline;
  }

  .primary-btn {
    margin-top: 0.5rem;
    width: 100%;
    border-radius: 0.7rem;
    border: none;
    outline: none;
    padding: 0.7rem 0.9rem;
    font-size: 0.9rem;
    font-weight: 600;
    background: #020617;
    color: #f9fafb;
    cursor: pointer;
  }

  .primary-btn:hover {
    background: #020617;
    opacity: 0.92;
  }

  .footnote {
    margin: 0;
    font-size: 0.75rem;
    color: #9ca3af;
  }

  @media (max-width: 768px) {
    .layout {
      flex-direction: column;
    }

    .sidebar {
      width: 100%;
    }

    .shell-card {
      width: 100%;
    }

    .table {
      font-size: 0.8rem;
    }

    .cell-url {
      max-width: 180px;
    }

    .cell-content {
      max-width: 200px;
    }
  }

  .error {
    margin: 0;
    font-size: 0.8rem;
    color: #b91c1c;
  }

  .brand-mark-large {
    width: 2.25rem;
    height: 2.25rem;
  }
  .alert {
    margin: 0;
    font-size: 0.8rem;
    padding: 0.75rem 0.9rem;
    border-radius: 0.75rem;
    display: flex;
    align-items: flex-start;
    gap: 0.5rem;
  }

  .alert-error {
    background: #fef2f2;
    border: 1px solid #fecaca;
    color: #b91c1c;
  }

  .alert-success {
    background: #ecfdf5;
    border: 1px solid #bbf7d0;
    color: #166534;
  }

  .alert-icon {
    font-size: 1rem;
    line-height: 1;
  }

  .dashboard-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 0.75rem;
  }

  .logout-btn {
    border-radius: 999px;
    border: 1px solid #e5e7eb;
    padding: 0.4rem 0.85rem;
    font-size: 0.8rem;
    background: #ffffff;
    color: #0f172a;
    cursor: pointer;
  }

  .logout-btn:hover {
    background: #f9fafb;
  }

  .info-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(0, 1fr));
    gap: 0.75rem;
    margin-top: 1rem;
    font-size: 0.85rem;
  }

  .info-label {
    color: #6b7280;
  }

  .info-value {
    color: #111827;
    font-weight: 500;
  }

  .table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 1rem;
    font-size: 0.85rem;
  }

  .table th,
  .table td {
    border-bottom: 1px solid #e5e7eb;
    padding: 0.5rem 0.75rem;
    text-align: left;
  }

  .table th {
    font-size: 0.8rem;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: #6b7280;
    background-color: #f9fafb;
  }

  .table tr:last-child td {
    border-bottom: none;
  }

  .table-wrapper {
    width: 100%;
    margin-top: 1rem;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
  }

  .cell-mono {
    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono',
      'Courier New', monospace;
    font-size: 0.78rem;
  }

  .cell-url {
    max-width: 260px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .cell-nowrap {
    white-space: nowrap;
  }

  .cell-content {
    max-width: 260px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .badge {
    display: inline-flex;
    align-items: center;
    border-radius: 999px;
    background: #eff6ff;
    color: #1d4ed8;
    padding: 0.15rem 0.45rem;
    font-size: 0.7rem;
    font-weight: 500;
  }

  .input-inline {
    border-radius: 0.5rem;
    border: 1px solid #d1d5db;
    padding: 0.3rem 0.5rem;
    font-size: 0.8rem;
    width: 100%;
  }

  .table-actions {
    display: flex;
    gap: 0.4rem;
  }

  .btn-table {
    border-radius: 999px;
    border: 1px solid #e5e7eb;
    padding: 0.25rem 0.7rem;
    font-size: 0.75rem;
    background: #ffffff;
    color: #0f172a;
    cursor: pointer;
  }

  .btn-table:hover {
    background: #f9fafb;
  }

  .btn-danger {
    border-color: #fecaca;
    color: #b91c1c;
  }

  .btn-danger:hover {
    background: #fef2f2;
  }

  .btn-icon {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding-inline: 0.45rem;
  }

  .icon-eye {
    position: relative;
    display: inline-block;
    width: 0.9rem;
    height: 0.55rem;
    border-radius: 999px;
    border: 1.5px solid #0f172a;
  }

  .icon-eye::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0.22rem;
    height: 0.22rem;
    border-radius: 999px;
    background: #0f172a;
    transform: translate(-50%, -50%);
  }

  .section-heading {
    margin-top: 1.75rem;
  }

  .section-title {
    margin: 0;
    font-size: 0.98rem;
    font-weight: 600;
    color: #111827;
  }

  .section-subtitle {
    margin: 0.2rem 0 0;
    font-size: 0.8rem;
    color: #6b7280;
  }
</style>

<main class="page page--auth" *ngIf="!isAuthenticated() && !showSplash(); else shell">
  <section class="card" aria-label="Halaman login admin">
    <header class="card-header">
      <div class="brand-row">
        <div class="brand-mark" aria-hidden="true">
          <span class="brand-mark-cross-vert"></span>
          <span class="brand-mark-cross-horz"></span>
        </div>
        <div class="brand-text">
          <span class="brand-name">Renunganku</span>
          <span class="brand-subtitle">Admin Panel</span>
        </div>
      </div>
      <h1>Masuk ke panel admin Renunganku</h1>
      <p class="lead">Gunakan kredensial admin yang diberikan oleh super admin.</p>
    </header>

    <form class="form" (submit)="onSubmit($event)">
      <div class="field">
        <label for="email">Email admin</label>
        <input
          id="email"
          name="email"
          type="email"
          autocomplete="username"
          placeholder="admin@renunganku.id"
          required
        />
      </div>

      <div class="field">
        <label for="password">Kata sandi</label>
        <input
          id="password"
          name="password"
          type="password"
          autocomplete="current-password"
          placeholder="Masukkan kata sandi"
          required
        />
      </div>

      <div class="form-row">
        <label class="remember">
          <input type="checkbox" />
          <span>Ingat saya di perangkat ini</span>
        </label>
      </div>

      <button type="submit" class="primary-btn" [disabled]="isSubmitting()">
        {{ isSubmitting() ? 'Memeriksa...' : 'Masuk' }}
      </button>
    </form>
    <div *ngIf="serverError()" class="alert alert-error" aria-live="assertive">
      <span class="alert-icon">!</span>
      <span>{{ serverError() }}</span>
    </div>
    <div *ngIf="successMessage()" class="alert alert-success" aria-live="polite">
      <span class="alert-icon">âœ“</span>
      <span>{{ successMessage() }}</span>
    </div>
    <p class="footnote">Akses hanya untuk tim internal. Aktivitas mungkin dipantau.</p>
  </section>
</main>

<ng-template #shell>
  <main class="page page--shell">
    <div class="layout">
      <aside class="sidebar" aria-label="Navigasi admin">
        <div>
          <div class="brand-row">
            <div class="brand-mark brand-mark-large" aria-hidden="true">
              <span class="brand-mark-cross-vert"></span>
              <span class="brand-mark-cross-horz"></span>
            </div>
            <div class="brand-text">
              <span class="brand-name">Renunganku</span>
              <span class="brand-subtitle">Admin</span>
            </div>
          </div>
        </div>

        <div class="sidebar-nav">
          <div class="sidebar-title">Menu</div>
          <div
            class="sidebar-nav-item"
            [class.sidebar-nav-item--active]="activeSection() === 'dashboard'"
            (click)="setActiveSection('dashboard')"
          >
            Dashboard
          </div>
          <div
            class="sidebar-nav-item"
            [class.sidebar-nav-item--active]="activeSection() === 'users'"
            (click)="setActiveSection('users')"
          >
            Manajemen Pengguna
          </div>
          <div
            class="sidebar-nav-item"
            [class.sidebar-nav-item--active]="activeSection() === 'posts'"
            (click)="setActiveSection('posts')"
          >
            Manajemen Postingan
          </div>
          <div
            class="sidebar-nav-item"
            [class.sidebar-nav-item--active]="activeSection() === 'media'"
            (click)="setActiveSection('media')"
          >
            Manajemen Media
          </div>
          <div
            class="sidebar-nav-item"
            [class.sidebar-nav-item--active]="activeSection() === 'blog'"
            (click)="setActiveSection('blog')"
          >
            Blog Posts
          </div>
        </div>

        <div class="sidebar-footer">
          Panel administrasi Renunganku.
        </div>
      </aside>

      <!-- Splash dengan logo besar sebelum dashboard -->
      <section
        *ngIf="showSplash(); else adminDashboard"
        class="card shell-card"
        aria-label="Splash admin"
      >
        <header class="card-header">
          <div class="brand-row">
            <div class="brand-mark brand-mark-large" aria-hidden="true">
              <span class="brand-mark-cross-vert"></span>
              <span class="brand-mark-cross-horz"></span>
            </div>
            <div class="brand-text">
              <span class="brand-name">Renunganku</span>
              <span class="brand-subtitle">Memuat Dashboard...</span>
            </div>
          </div>
          <h1>Admin Renunganku</h1>
          <p class="lead">Menyiapkan panel administrasi untuk Anda.</p>
        </header>
      </section>

      <!-- Dashboard admin utama -->
      <ng-template #adminDashboard>
        <!-- Halaman utama dashboard -->
        <section
          *ngIf="activeSection() === 'dashboard'; else usersSection"
          class="card shell-card"
          aria-label="Dashboard admin"
        >
          <header class="card-header">
            <div class="dashboard-header">
              <div>
                <div class="brand-row">
                  <div class="brand-mark brand-mark-large" aria-hidden="true">
                    <span class="brand-mark-cross-vert"></span>
                    <span class="brand-mark-cross-horz"></span>
                  </div>
                  <div class="brand-text">
                    <span class="brand-name">Renunganku</span>
                    <span class="brand-subtitle">Admin Dashboard</span>
                  </div>
                </div>
                <h1>Dashboard Admin</h1>
                <p class="lead">Selamat datang di panel administrasi Renunganku.</p>
              </div>
              <button type="button" class="logout-btn" (click)="onLogout()">
                Logout
              </button>
            </div>
          </header>

          <div class="info-grid" aria-label="Ringkasan admin">
            <div>
              <div class="info-label">Email admin</div>
              <div class="info-value">
                {{ adminEmail() || 'Tidak diketahui' }}
              </div>
            </div>
          </div>

          <p class="footnote">Konten dashboard akan ditambahkan di sini.</p>
        </section>
      </ng-template>

      <!-- Halaman manajemen (pengguna atau postingan) -->
      <ng-template #usersSection>
        <!-- Jika section = users -->
        <section
          *ngIf="activeSection() === 'users'; else postsSection"
          class="card shell-card"
          aria-label="Manajemen pengguna"
        >
          <header class="card-header">
            <div class="dashboard-header">
              <div>
                <h1>Manajemen Pengguna</h1>
                <p class="lead">
                  Data diambil langsung dari tabel <span class="badge">User</span> di database
                  yang digunakan NestJS.
                </p>
              </div>
              <button type="button" class="logout-btn" (click)="onLogout()">
                Logout
              </button>
            </div>
          </header>

          <div *ngIf="isLoadingUsers(); else usersLoaded">
            <p class="footnote">Memuat data pengguna...</p>
          </div>

          <ng-template #usersLoaded>
            <div *ngIf="usersError(); else usersTable">
              <p class="footnote">{{ usersError() }}</p>
            </div>

            <ng-template #usersTable>
              <div class="table-wrapper">
                <table class="table" aria-label="Daftar pengguna">
                  <thead>
                    <tr>
                      <th>Email</th>
                      <th>Nama lengkap</th>
                      <th>Dibuat</th>
                      <th>ID</th>
                      <th>Aksi</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let user of users() || []">
                      <td>
                        <ng-container *ngIf="editingUserId() === user.id; else viewEmail">
                          <input
                            class="input-inline"
                            type="email"
                            [value]="editEmail()"
                            (input)="editEmail.set($any($event.target).value)"
                          />
                        </ng-container>
                        <ng-template #viewEmail>
                          {{ user.email }}
                        </ng-template>
                      </td>
                      <td>
                        <ng-container *ngIf="editingUserId() === user.id; else viewNama">
                          <input
                            class="input-inline"
                            type="text"
                            [value]="editNamaLengkap()"
                            (input)="editNamaLengkap.set($any($event.target).value)"
                          />
                        </ng-container>
                        <ng-template #viewNama>
                          {{ user.namaLengkap || '-' }}
                        </ng-template>
                      </td>
                      <td class="cell-nowrap">{{ user.createdAt }}</td>
                      <td class="cell-mono cell-nowrap">{{ user.id }}</td>
                      <td>
                        <div class="table-actions">
                          <ng-container *ngIf="editingUserId() === user.id; else editDeleteBtns">
                            <button
                              type="button"
                              class="btn-table"
                              (click)="saveUserEdit()"
                              [disabled]="isSavingUser()"
                            >
                              Simpan
                            </button>
                            <button
                              type="button"
                              class="btn-table"
                              (click)="cancelEditUser()"
                              [disabled]="isSavingUser()"
                            >
                              Batal
                            </button>
                          </ng-container>
                          <ng-template #editDeleteBtns>
                            <button
                              type="button"
                              class="btn-table"
                              (click)="startEditUser(user)"
                              [disabled]="deletingUserId() === user.id"
                            >
                              Edit
                            </button>
                            <button
                              type="button"
                              class="btn-table btn-danger"
                              (click)="deleteUser(user)"
                              [disabled]="deletingUserId() === user.id"
                            >
                              {{ deletingUserId() === user.id ? 'Menghapus...' : 'Hapus' }}
                            </button>
                          </ng-template>
                        </div>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </ng-template>
          </ng-template>
        </section>

        <!-- Jika section = posts, media, atau blog -->
        <ng-template #postsSection>
          <!-- Manajemen postingan -->
          <section
            *ngIf="activeSection() === 'posts'; else mediaOrBlogSection"
            class="card shell-card"
            aria-label="Manajemen postingan"
          >
            <header class="card-header">
              <div class="dashboard-header">
                <div>
                  <h1>Manajemen Postingan</h1>
                  <p class="lead">
                    Data diambil dari tabel <span class="badge">Post</span> dan relasi
                    pengarang <span class="badge">User</span>.
                  </p>
                </div>
                <button type="button" class="logout-btn" (click)="onLogout()">
                  Logout
                </button>
              </div>
            </header>

            <div *ngIf="isLoadingPosts(); else postsLoaded">
              <p class="footnote">Memuat data postingan...</p>
            </div>

            <ng-template #postsLoaded>
              <div *ngIf="postsError(); else postsTable">
                <p class="footnote">{{ postsError() }}</p>
              </div>

              <ng-template #postsTable>
                <div class="table-wrapper">
                  <table class="table" aria-label="Daftar postingan">
                    <thead>
                      <tr>
                        <th>Judul</th>
                        <th>Konten</th>
                        <th>Penulis</th>
                        <th>Dibuat</th>
                        <th>ID</th>
                        <th>Aksi</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr *ngFor="let post of posts() || []">
                        <td>
                          <ng-container *ngIf="editingPostId() === post.id; else viewTitle">
                            <input
                              class="input-inline"
                              type="text"
                              [value]="editPostTitle()"
                              (input)="editPostTitle.set($any($event.target).value)"
                            />
                          </ng-container>
                          <ng-template #viewTitle>
                            {{ post.title || '(Tanpa judul)' }}
                          </ng-template>
                        </td>
                        <td class="cell-content">
                          <ng-container *ngIf="editingPostId() === post.id; else viewContent">
                            <input
                              class="input-inline"
                              type="text"
                              [value]="editPostContent()"
                              (input)="editPostContent.set($any($event.target).value)"
                            />
                          </ng-container>
                          <ng-template #viewContent>
                            {{ post.content }}
                          </ng-template>
                        </td>
                        <td>{{ post.authorEmail }}</td>
                        <td class="cell-nowrap">{{ post.createdAt }}</td>
                        <td class="cell-mono cell-nowrap">{{ post.id }}</td>
                        <td>
                          <div class="table-actions">
                            <ng-container *ngIf="editingPostId() === post.id; else postEditDeleteBtns">
                              <button
                                type="button"
                                class="btn-table"
                                (click)="savePostEdit()"
                                [disabled]="isSavingPost()"
                              >
                                Simpan
                              </button>
                              <button
                                type="button"
                                class="btn-table"
                                (click)="cancelEditPost()"
                                [disabled]="isSavingPost()"
                              >
                                Batal
                              </button>
                            </ng-container>
                            <ng-template #postEditDeleteBtns>
                              <button
                                type="button"
                                class="btn-table"
                                (click)="startEditPost(post)"
                                [disabled]="deletingPostId() === post.id"
                              >
                                Edit
                              </button>
                              <button
                                type="button"
                                class="btn-table btn-danger"
                                (click)="deletePost(post)"
                                [disabled]="deletingPostId() === post.id"
                              >
                                {{ deletingPostId() === post.id ? 'Menghapus...' : 'Hapus' }}
                              </button>
                            </ng-template>
                          </div>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </ng-template>
            </ng-template>
          </section>

          <!-- Manajemen media (gambar & video) atau blog -->
          <ng-template #mediaOrBlogSection>
            <!-- Manajemen media (gambar & video) -->
            <section
              *ngIf="activeSection() === 'media'; else blogSection"
              class="card shell-card"
              aria-label="Manajemen media"
            >
              <header class="card-header">
                <div class="dashboard-header">
                  <div>
                    <h1>Manajemen Media</h1>
                    <p class="lead">
                      Mengelola konten gambar &amp; video dari tabel
                      <span class="badge">PostImage</span> dan
                      <span class="badge">PostVideo</span>.
                    </p>
                  </div>
                  <button type="button" class="logout-btn" (click)="onLogout()">
                    Logout
                  </button>
                </div>
              </header>

              <div *ngIf="isLoadingMedia(); else mediaLoaded">
                <p class="footnote">Memuat data media...</p>
              </div>

              <ng-template #mediaLoaded>
                <div *ngIf="mediaError(); else mediaTable">
                  <p class="footnote">{{ mediaError() }}</p>
                </div>

                <ng-template #mediaTable>
                  <div class="table-wrapper">
                    <table class="table" aria-label="Daftar media">
                      <thead>
                        <tr>
                          <th>Jenis</th>
                          <th>URL</th>
                          <th>Post ID</th>
                          <th>Penulis</th>
                          <th>Dibuat</th>
                          <th>Durasi</th>
                          <th>Aksi</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr *ngFor="let item of media() || []">
                          <td class="cell-nowrap">
                            {{ item.kind === 'image' ? 'Gambar' : 'Video' }}
                          </td>
                          <td class="cell-mono cell-url" [title]="item.url">
                            {{ item.url }}
                          </td>
                          <td class="cell-mono cell-nowrap">
                            {{ item.postId }}
                          </td>
                          <td>{{ item.authorEmail }}</td>
                          <td class="cell-nowrap">{{ item.createdAt }}</td>
                          <td class="cell-nowrap">
                            {{ item.kind === 'video' && item.duration != null
                              ? (item.duration | number:'1.0-1') + ' dtk'
                              : '-' }}
                          </td>
                          <td>
                            <div class="table-actions">
                              <a
                                class="btn-table btn-icon"
                                [href]="item.url"
                                target="_blank"
                                rel="noopener noreferrer"
                                aria-label="Preview media"
                              >
                                <span class="icon-eye" aria-hidden="true"></span>
                              </a>
                              <button
                                type="button"
                                class="btn-table btn-danger"
                                (click)="deleteMedia(item)"
                                [disabled]="deletingMediaId() === item.id"
                              >
                                {{ deletingMediaId() === item.id ? 'Menghapus...' : 'Hapus' }}
                              </button>
                            </div>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </ng-template>

                <!-- Bagian manajemen story -->
                <div class="section-heading" style="margin-top: 2rem;">
                  <h2 class="section-title">Manajemen Story</h2>
                  <p class="section-subtitle">
                    Story yang diunggah pengguna (gambar &amp; video) dari tabel
                    <span class="badge">Story</span>.
                  </p>
                </div>

                <div *ngIf="isLoadingStories(); else storiesLoaded">
                  <p class="footnote">Memuat data story...</p>
                </div>

                <ng-template #storiesLoaded>
                  <div *ngIf="storiesError(); else storiesTable">
                    <p class="footnote">{{ storiesError() }}</p>
                  </div>

                  <ng-template #storiesTable>
                    <div class="table-wrapper">
                      <table class="table" aria-label="Daftar story">
                        <thead>
                          <tr>
                            <th>Jenis</th>
                            <th>Caption</th>
                            <th>Media URL</th>
                            <th>Pengguna</th>
                            <th>Dibuat</th>
                            <th>Kedaluwarsa</th>
                            <th>ID</th>
                            <th>Aksi</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr *ngFor="let story of stories() || []">
                            <td class="cell-nowrap">
                              {{ story.type === 'VIDEO' ? 'Video' : 'Gambar' }}
                            </td>
                            <td class="cell-content">
                              <ng-container *ngIf="editingStoryId() === story.id; else viewCaption">
                                <input
                                  class="input-inline"
                                  type="text"
                                  [value]="editStoryCaption()"
                                  (input)="editStoryCaption.set($any($event.target).value)"
                                />
                              </ng-container>
                              <ng-template #viewCaption>
                                {{ story.caption || '-' }}
                              </ng-template>
                            </td>
                            <td class="cell-mono cell-url" [title]="story.mediaUrl">
                              {{ story.mediaUrl }}
                            </td>
                            <td>{{ story.userEmail }}</td>
                            <td class="cell-nowrap">{{ story.createdAt }}</td>
                            <td class="cell-nowrap">{{ story.expiresAt }}</td>
                            <td class="cell-mono cell-nowrap">{{ story.id }}</td>
                            <td>
                              <div class="table-actions">
                                <ng-container *ngIf="editingStoryId() === story.id; else storyEditDeleteBtns">
                                  <button
                                    type="button"
                                    class="btn-table"
                                    (click)="saveStoryEdit()"
                                    [disabled]="isSavingStory()"
                                  >
                                    Simpan
                                  </button>
                                  <button
                                    type="button"
                                    class="btn-table"
                                    (click)="cancelEditStory()"
                                    [disabled]="isSavingStory()"
                                  >
                                    Batal
                                  </button>
                                </ng-container>
                                <ng-template #storyEditDeleteBtns>
                                  <a
                                    class="btn-table btn-icon"
                                    [href]="story.mediaUrl"
                                    target="_blank"
                                    rel="noopener noreferrer"
                                    aria-label="Preview story"
                                  >
                                    <span class="icon-eye" aria-hidden="true"></span>
                                  </a>
                                  <button
                                    type="button"
                                    class="btn-table"
                                    (click)="startEditStory(story)"
                                    [disabled]="deletingStoryId() === story.id"
                                  >
                                    Edit
                                  </button>
                                  <button
                                    type="button"
                                    class="btn-table btn-danger"
                                    (click)="deleteStory(story)"
                                    [disabled]="deletingStoryId() === story.id"
                                  >
                                    {{ deletingStoryId() === story.id ? 'Menghapus...' : 'Hapus' }}
                                  </button>
                                </ng-template>
                              </div>
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </ng-template>
                </ng-template>
              </ng-template>
            </section>
            <!-- Manajemen Blog Post -->
            <ng-template #blogSection>
              <section
                class="card shell-card"
                aria-label="Manajemen blog post"
              >
                <header class="card-header">
                  <div class="dashboard-header">
                    <div>
                      <h1>Manajemen Blog Post</h1>
                      <p class="lead">
                        Konten blog dari tabel <span class="badge">BlogPost</span> di database
                        Renunganku.
                      </p>
                    </div>
                    <button type="button" class="logout-btn" (click)="onLogout()">
                      Logout
                    </button>
                  </div>
                </header>

                <section aria-label="Form blog post baru" style="margin-top: 1rem;">
                  <div class="table-actions" style="margin-bottom: 0.75rem;">
                    <button type="button" class="btn-table" (click)="startNewBlogPost()">
                      {{ editingBlogId() ? 'Buat baru' : 'Reset form' }}
                    </button>
                  </div>

                  <div *ngIf="blogError()" class="alert alert-error" aria-live="assertive">
                    <span class="alert-icon">!</span>
                    <span>{{ blogError() }}</span>
                  </div>

                  <form class="form" (submit)="$event.preventDefault(); saveBlogPost();">
                    <div class="field">
                      <label for="blog-title">Judul</label>
                      <input
                        id="blog-title"
                        type="text"
                        [value]="blogTitle()"
                        (input)="blogTitle.set($any($event.target).value)"
                        required
                      />
                    </div>

                    <div class="field">
                      <label for="blog-slug">Slug</label>
                      <div class="table-actions">
                        <input
                          id="blog-slug"
                          type="text"
                          [value]="blogSlug()"
                          (input)="blogSlug.set($any($event.target).value); slugAvailable.set(null)"
                          style="flex: 1;"
                          required
                        />
                        <button
                          type="button"
                          class="btn-table"
                          (click)="generateBlogSlugFromTitle()"
                        >
                          Dari judul
                        </button>
                        <button
                          type="button"
                          class="btn-table"
                          (click)="checkBlogSlugUnique()"
                          [disabled]="isCheckingSlug() || !blogSlug().trim()"
                        >
                          {{ isCheckingSlug() ? 'Memeriksa...' : 'Cek slug' }}
                        </button>
                      </div>
                      <p class="footnote">Gunakan huruf kecil, angka, dan tanda hubung.</p>
                      <p class="footnote" *ngIf="slugAvailable() === true">
                        Slug tersedia.
                      </p>
                      <p class="footnote" *ngIf="slugAvailable() === false">
                        Slug sudah digunakan, pilih slug lain.
                      </p>
                    </div>

                    <div class="field">
                      <label for="blog-excerpt">Excerpt</label>
                      <textarea
                        id="blog-excerpt"
                        rows="3"
                        [value]="blogExcerpt()"
                        (input)="blogExcerpt.set($any($event.target).value)"
                      ></textarea>
                    </div>

                    <div class="field">
                      <label for="blog-body">Body (Markdown)</label>
                      <textarea
                        id="blog-body"
                        rows="8"
                        [value]="blogBody()"
                        (input)="blogBody.set($any($event.target).value)"
                      ></textarea>
                    </div>

                    <div class="field">
                      <label for="blog-category">Kategori</label>
                      <select
                        id="blog-category"
                        [value]="blogCategory()"
                        (change)="blogCategory.set($any($event.target).value)"
                      >
                        <option value="ProductAndVision">Product &amp; Vision</option>
                        <option value="Engineering">Engineering</option>
                        <option value="Design">Design</option>
                        <option value="Culture">Culture</option>
                      </select>
                    </div>

                    <div class="field">
                      <label for="blog-readtime">Waktu baca (menit)</label>
                      <input
                        id="blog-readtime"
                        type="number"
                        min="1"
                        [value]="blogReadTimeMinutes()"
                        (input)="onBlogReadTimeInput($any($event.target).value)"
                      />
                    </div>

                    <div class="field">
                      <label for="blog-published-at">Published at (opsional)</label>
                      <input
                        id="blog-published-at"
                        type="text"
                        placeholder="2025-01-10T07:00:00Z"
                        [value]="blogPublishedAt() || ''"
                        (input)="blogPublishedAt.set($any($event.target).value)"
                      />
                      <p class="footnote">
                        Untuk status <strong>SCHEDULED</strong>, wajib diisi. Jika
                        <strong>PUBLISHED</strong> dan kosong, backend akan mengisi dengan waktu saat ini.
                      </p>
                    </div>

                    <div class="field">
                      <label for="blog-author-name">Nama penulis</label>
                      <input
                        id="blog-author-name"
                        type="text"
                        [value]="blogAuthorName()"
                        (input)="blogAuthorName.set($any($event.target).value)"
                      />
                    </div>

                    <div class="field">
                      <label for="blog-author-role">Peran penulis</label>
                      <input
                        id="blog-author-role"
                        type="text"
                        [value]="blogAuthorRole()"
                        (input)="blogAuthorRole.set($any($event.target).value)"
                      />
                    </div>

                    <div class="field">
                      <label for="blog-tags">Tags</label>
                      <input
                        id="blog-tags"
                        type="text"
                        placeholder="contoh: launch, product, community"
                        [value]="blogTagsInput()"
                        (input)="blogTagsInput.set($any($event.target).value)"
                      />
                      <p class="footnote">Pisahkan dengan koma.</p>
                    </div>

                    <div class="field">
                      <label for="blog-status">Status</label>
                      <select
                        id="blog-status"
                        [value]="blogStatus()"
                        (change)="blogStatus.set($any($event.target).value)"
                      >
                        <option value="DRAFT">DRAFT</option>
                        <option value="SCHEDULED">SCHEDULED</option>
                        <option value="PUBLISHED">PUBLISHED</option>
                      </select>
                    </div>

                    <div class="table-actions" style="margin-top: 0.5rem;">
                      <button
                        type="submit"
                        class="btn-table"
                        [disabled]="isSavingBlog()"
                      >
                        {{ isSavingBlog() ? 'Menyimpan...' : (editingBlogId() ? 'Update blog post' : 'Simpan blog post') }}
                      </button>
                    </div>
                  </form>
                </section>

                <section aria-label="Daftar blog post" style="margin-top: 2rem;">
                  <h2 class="section-title">Daftar Blog Post</h2>
                  <p class="section-subtitle">
                    Postingan terbaru akan tampil di publik pada halaman <span class="badge">/blog</span>.
                  </p>

                  <div *ngIf="isLoadingBlog(); else blogLoaded">
                    <p class="footnote">Memuat data blog post...</p>
                  </div>

                  <ng-template #blogLoaded>
                    <div *ngIf="blogError(); else blogTable">
                      <p class="footnote">{{ blogError() }}</p>
                    </div>

                    <ng-template #blogTable>
                      <div class="table-wrapper">
                        <table class="table" aria-label="Daftar blog post">
                          <thead>
                            <tr>
                              <th>Judul</th>
                              <th>Slug</th>
                              <th>Kategori</th>
                              <th>Status</th>
                              <th>Waktu baca</th>
                              <th>Published at</th>
                              <th>Dibuat</th>
                              <th>Aksi</th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr *ngFor="let post of blogPosts() || []">
                              <td class="cell-content">{{ post.title }}</td>
                              <td class="cell-mono cell-url">{{ post.slug }}</td>
                              <td>{{ post.category }}</td>
                              <td>{{ post.status }}</td>
                              <td class="cell-nowrap">{{ post.readTimeMinutes }} mnt</td>
                              <td class="cell-nowrap">{{ post.publishedAt || '-' }}</td>
                              <td class="cell-nowrap">{{ post.createdAt }}</td>
                              <td>
                                <div class="table-actions">
                                  <button
                                    type="button"
                                    class="btn-table"
                                    (click)="startEditBlogPost(post)"
                                  >
                                    Edit
                                  </button>
                                </div>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </ng-template>
                  </ng-template>
                </section>
              </section>
            </ng-template>
          </ng-template>
        </ng-template>
      </ng-template>
    </div>
  </main>
</ng-template>
